<!-- Place this at the bottom of your worksheet form section -->
<button onclick="exportToWord()" style="margin-top:32px; background: #ba372a; color:#fff; border:none; border-radius:4px; padding:12px 30px; font-size:1.15em; font-family: Arial, Helvetica, sans-serif; cursor:pointer;">
    Export to Word
</button>
<script>
function exportToWord() {
    // Gather all text/textarea/input fields in order
    let content = '<h2 style="color:#ba372a;font-family:Arial;">From SWOT to Persona-Ready Ideas</h2>';

    // SWOT
    content += '<h3 style="color:#1b4b7d;font-family:Arial;">1. SWOT Analysis</h3>';
    ['Strengths','Weaknesses','Opportunities','Threats'].forEach(function(swotType) {
        content += `<h4 style="color:#1b4b7d;font-family:Arial;margin-top:24px;">${swotType}</h4>`;
        content += '<table style="width:100%;border-collapse:collapse;margin-bottom:8px;font-family:Arial;"><tr><th style=\'background:#f6f6f6;padding:6px;\'>'+swotType.slice(0,-1)+' Point</th><th style=\'background:#f6f6f6;padding:6px;\'>Source / Evidence</th></tr>';
        for(let i=1;i<=3;i++) {
            let v1 = document.getElementById(swotType+'_'+i+'_1')?.value||'';
            let v2 = document.getElementById(swotType+'_'+i+'_2')?.value||'';
            content += `<tr><td style='padding:5px;'>${v1}</td><td style='padding:5px;'>${v2}</td></tr>`;
        }
        content += '</table>';
    });

    // Segmentation
    content += '<h3 style="color:#1b4b7d;font-family:Arial;">2. Segmentation â€“ Four Lenses</h3>';
    content += "<table style='width:100%;border-collapse:collapse;font-family:Arial;'><tr><th style='background:#f6f6f6;'>Lens</th><th style='background:#f6f6f6;'>Segment Detail</th><th style='background:#f6f6f6;'>Evidence / Source</th></tr>";
    ['Geographic','Demographic','Psychographic','Behavioural'].forEach(function(seg,i) {
        let d = document.getElementById('Seg_'+i+'_d')?.value||'';
        let s = document.getElementById('Seg_'+i+'_s')?.value||'';
        content += `<tr><td style='padding:5px;'>${seg}</td><td style='padding:5px;'>${d}</td><td style='padding:5px;'>${s}</td></tr>`;
    });
    content += '</table>';

    // JTBD
    content += '<h3 style="color:#1b4b7d;font-family:Arial;">3. Jobs to Be Done (JTBD)</h3>';
    content += "<table style='width:100%;border-collapse:collapse;font-family:Arial;'><tr><th style='background:#f6f6f6;'>Type</th><th style='background:#f6f6f6;'>Statement</th><th style='background:#f6f6f6;'>Importance</th><th style='background:#f6f6f6;'>Satisfaction</th><th style='background:#f6f6f6;'>Evidence</th></tr>";
    ['Functional','Emotional','Social'].forEach(function(j,i){
        let stmt = document.getElementById('JTBD_'+i+'_stmt')?.value||'';
        let imp = document.getElementById('JTBD_'+i+'_imp')?.value||'';
        let sat = document.getElementById('JTBD_'+i+'_sat')?.value||'';
        let ev = document.getElementById('JTBD_'+i+'_ev')?.value||'';
        content += `<tr><td style='padding:5px;'>${j}</td><td style='padding:5px;'>${stmt}</td><td style='padding:5px;'>${imp}</td><td style='padding:5px;'>${sat}</td><td style='padding:5px;'>${ev}</td></tr>`;
    });
    content += '</table>';
    let jtbdJust = document.getElementById('JTBD_just')?.value||'';
    content += '<b>JTBD justification:</b> ' + jtbdJust + '<br>';

    // Persona
    content += '<h3 style="color:#1b4b7d;font-family:Arial;">4. Persona Card</h3>';
    let personaLabels = [
        'Name','Short Description','Goals / Desired Outcomes','Pain Points','JTBD Link','Quote','Success Metric','Media/Info Habits'
    ];
    content += "<table style='width:100%;border-collapse:collapse;font-family:Arial;'>";
    personaLabels.forEach(function(l,i){
        let v = document.getElementById('Persona_'+i)?.value||'';
        content += `<tr><td style='background:#f6f6f6;padding:5px;width:25%;'><b>${l}</b></td><td style='padding:5px;'>${v}</td></tr>`;
    });
    content += '</table>';

    // Export
    var header = "<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><title>SWOT to Persona Worksheet</title></head><body>"+content+"</body></html>";
    var blob = new Blob(['\ufeff', header], { type: 'application/msword' });
    var url = URL.createObjectURL(blob);
    var link = document.createElement('a');
    link.href = url;
    link.download = "SWOT-to-Persona-Worksheet.doc";
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
}
</script>
